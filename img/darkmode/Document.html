<!DOCTYPE html>
<!-- saved from url=(0022)http://127.0.0.1:4000/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
跨域
<script>
function jsonp({ url, params, callback }) {
  return new Promise((resolve, reject) => {
    let script = document.createElement('script')
		// window 上用 callback 名字挂一个函数
    window[callback] = function(data) {
      resolve(data)
      document.body.removeChild(script)
    }
    params = { ...params, callback } // wd=b&callback=show
    let arrs = []
    for (let key in params) {
      arrs.push(`${key}=${params[key]}`)
    }
    script.src = `${url}?${arrs.join('&')}`
    document.body.appendChild(script)
		// script 执行的时候调上面的那个函数即可拿到返回值
  })
}
jsonp({
	url: 'http://localhost:4001/say',
	param: { wd: 'Iloveyou' },
	callback: 'show'
}).then(data => {
	console.log(data);
});
</script><script src="./Document_files/say"></script>

</body></html>